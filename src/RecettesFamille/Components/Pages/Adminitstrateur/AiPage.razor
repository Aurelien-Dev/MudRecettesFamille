@page "/Admin/ai"
@using Microsoft.AspNetCore.Authorization
@using RecettesFamille.Ai.Services.Ingestion
@using RecettesFamille.Components.Layout
@using RecettesFamille.Data
@inject ApplicationDbContext dbContext
@inject IServiceProvider service

@attribute [Authorize(Roles = "Admin, Contributor")]
@layout AdminLayout

<AuthorizeView Roles="Admin">
    <p>Bienvenue, Administrateur !</p>
</AuthorizeView>
<AuthorizeView Roles="Contributor">
    <p>Bienvenue, Contributor !</p>
</AuthorizeView>
<AuthorizeView Roles="Reader">
    <p>Bienvenue, Reader !</p>
</AuthorizeView>



@code {


    public async Task IngestNewData()
    {
        await DataIngestor.IngestDataAsync(service, new SQLRecipeSource(dbContext));
    }
}
