@page "/favorites"
@attribute [Authorize(Roles = "Reader")]

@using Microsoft.AspNetCore.Authorization
@using MudBlazor
@using RecettesFamille.Components.Pages.RecetteBook.Components
@using RecettesFamille.Data.Repository.IRepositories
@using RecettesFamille.Dto.ModelByPage.RecetteBook
@using RecettesFamille.Extensions

@inject IRecipeRepository RecipeRepository
@inject AuthenticationStateProvider AuthenticationStateProvider



<MudContainer MaxWidth="MaxWidth.ExtraLarge" Class="mt-3" Gutters="false">

	<MudText Typo="Typo.h5" Class="mb-3" Style="font-weight:900;">
		Mes recettes favorites 🍽️
	</MudText>

	@if (Recipes != null)
	{
		<MudGrid Class="" Justify="Justify.Center" Style="height:100%;">
			@foreach (var recipe in Recipes)
			{
				<MudItem xs="3">
					<RecipeCard Recipes="@recipe" />
				</MudItem>
			}
		</MudGrid>
	}

</MudContainer>

@code {

	List<RecipeForListDto> Recipes { get; set; } = new();

	protected override async Task OnParametersSetAsync()
	{
		var authState = await AuthenticationStateProvider.GetAuthenticationStateAsync();

		Recipes = await RecipeRepository.GetAllFavoritesLightRecipe(authState.User.Identity.Name);
	}
}